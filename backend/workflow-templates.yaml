templates:
  preprocessing:
    inputs:
      artifacts:
        - name: source-data
          path: /data/inputs/input.csv
        - name: preprocessing-config
          path: /data/config/preprocessing.yaml
    securityContext:
      runAsUser: 0
      runAsGroup: 0
    container:
      image: docker.io/library/preprocessing:latest
      imagePullPolicy: Never
      command: [python, preprocess.py]
    outputs:
      artifacts:
        - name: processed-data
          path: /data/outputs/preprocessed_input.csv
          archive:
            none: {}

  train-hmm-model:
    inputs:
      artifacts:
        - name: processed-data
          path: /data/inputs/preprocessed_input.csv
          archive:
            none: {}
        - name: training-hmm-config
          path: /data/config/training_hmm.json
    container:
      image: docker.io/library/training-hmm:latest
      imagePullPolicy: Never
      command: [python, entrenar_modelo.py]
    outputs:
      artifacts:
        - name: trained-model
          path: /data/outputs/hmm_model.pkl
          archive:
            none: {}

  generate-hmm-data:
    inputs:
      artifacts:
        - name: trained-model
          path: /data/inputs/hmm_model.pkl
          archive:
            none: {}
        - name: generation-hmm-config
          path: /data/config/generation_hmm.json
    container:
      image: docker.io/library/generation-hmm:latest
      imagePullPolicy: Never
      command: [python, generar_datos.py]
    outputs:
      artifacts:
        - name: synthetic-data
          path: /data/outputs/synthetic_hmm_model.csv
          archive:
            none: {}

  train-gaussian-process-model:
    inputs:
      artifacts:
        - name: processed-data
          path: /data/inputs/preprocessed_input.csv
          archive:
            none: {}
        - name: training-gaussian-process-config
          path: /data/config/training_gaussian_process.json
    container:
      image: docker.io/library/training-gaussian_process:latest
      imagePullPolicy: Never
      command: [python, model_generation.py]
    outputs:
      artifacts:
        - name: trained-model
          path: /data/outputs/gaussian_process_model.pkl
          archive:
            none: {}

  generate-gaussian-process-data:
    inputs:
      artifacts:
        - name: trained-model
          path: /data/inputs/gaussian_process_model.pkl
          archive:
            none: {}
        - name: generation-gaussian-process-config
          path: /data/config/generation_gaussian_process.json
    container:
      image: docker.io/library/generation-gaussian_process:latest
      imagePullPolicy: Never
      command: [python, data_generation.py]
    outputs:
      artifacts:
        - name: synthetic-data
          path: /data/outputs/synthetic_gaussian_process_model.csv
          archive:
            none: {}

  train-copulas-model:
    inputs:
      artifacts:
        - name: processed-data
          path: /data/inputs/preprocessed_input.csv
          archive:
            none: {}
        - name: training-copulas-config
          path: /data/config/training_copulas.json
    container:
      image: docker.io/library/training-copulas:latest
      imagePullPolicy: Never
      command: [python, model_generation.py]
    outputs:
      artifacts:
        - name: trained-model
          path: /data/outputs/copulas_model.pkl
          archive:
            none: {}

  generate-copulas-data:
    inputs:
      artifacts:
        - name: trained-model
          path: /data/inputs/copulas_model.pkl
          archive:
            none: {}
        - name: generation-copulas-config
          path: /data/config/generation_copulas.json
    container:
      image: docker.io/library/generation-copulas:latest
      imagePullPolicy: Never
      command: [python, data_generation.py]
    outputs:
      artifacts:
        - name: synthetic-data
          path: /data/outputs/synthetic_copulas_model.csv
          archive:
            none: {}

  train-boltzman-machines-model:
    inputs:
      artifacts:
        - name: processed-data
          path: /data/inputs/preprocessed_input.csv
          archive:
            none: {}
        - name: training-boltzman-machines-config
          path: /data/config/training_boltzman_machines.json
    container:
      image: docker.io/library/training-boltzman_machines:latest
      imagePullPolicy: Never
      command: [python, model_generation.py]
    outputs:
      artifacts:
        - name: trained-model
          path: /data/outputs/rbm_model.pkl
          archive:
            none: {}

  generate-boltzman-machines-data:
    inputs:
      artifacts:
        - name: trained-model
          path: /data/inputs/rbm_model.pkl
          archive:
            none: {}
        - name: generation-boltzman-machines-config
          path: /data/config/generation_boltzman_machines.json
    container:
      image: docker.io/library/generation-boltzman_machines:latest
      imagePullPolicy: Never
      command: [python, data_generation.py]
    outputs:
      artifacts:
        - name: synthetic-data
          path: /data/outputs/synthetic_rbm_model.csv
          archive:
            none: {}

  train-bayesian-networks-model:
    inputs:
      artifacts:
        - name: processed-data
          path: /data/inputs/preprocessed_input.csv
          archive:
            none: {}
        - name: training-bayesian-networks-config
          path: /data/config/training_bayesian_networks.json
    container:
      image: docker.io/library/training-bayesian_networks:latest
      imagePullPolicy: Never
      command: [python, model_generation.py]
    outputs:
      artifacts:
        - name: trained-model
          path: /data/outputs/bayesian_network_model.pkl
          archive:
            none: {}

  generate-bayesian-networks-data:
    inputs:
      artifacts:
        - name: trained-model
          path: /data/inputs/bayesian_network_model.pkl
          archive:
            none: {}
        - name: generation-bayesian-networks-config
          path: /data/config/generation_bayesian_networks.json
    container:
      image: docker.io/library/generation-bayesian_networks:latest
      imagePullPolicy: Never
      command: [python, data_generation.py]
    outputs:
      artifacts:
        - name: synthetic-data
          path: /data/outputs/synthetic_bayesian_network_model.csv
          archive:
            none: {}

  train-gym-pybullet-rl:
    inputs:
      artifacts:
        - name: training-gym-pybullet-config
          path: /data/config/variables.json
    container:
      image: docker.io/library/rl-gym-pybullet:latest
      imagePullPolicy: Never
      command: [python, /app/rl_example.py]
    outputs:
      artifacts:
        - name: rl-metrics
          path: /data/outputs/metrics.json
          archive:
            none: {}
        - name: rl-best-model
          path: /data/outputs/best_model.zip
          archive:
            none: {}
        - name: rl-final-model
          path: /data/outputs/final_model.zip
          archive:
            none: {}
        - name: rl-evaluations
          path: /data/outputs/evaluations.npz
          archive:
            none: {}

  bouncing-ball:
    inputs:
      artifacts:
        - name: bouncing-ball-config
          path: /tmp/config/bouncing_ball.json
    container:
      image: docker.io/library/bouncing-ball:latest
      imagePullPolicy: Never
      command: [python3, /app/run_simulation.py]
      args:
        [
          "--config",
          "{{inputs.artifacts.bouncing-ball-config.path}}",
          "--output",
          "/tmp/output/bouncing_ball.json",
        ]
    outputs:
      artifacts:
        - name: bouncing-ball-output
          path: /tmp/output/bouncing_ball.json
          archive:
            none: {}
