templates:
  preprocessing:
    inputs:
      artifacts:
        - name: source-data
          path: /tmp/input/data.csv
        - name: preprocessing-config
          path: /tmp/config/preprocessing.yaml
    securityContext:
      runAsUser: 0
      runAsGroup: 0
    container:
      image: docker.io/library/preprocessing:v2
      imagePullPolicy: Never
      command: [python, preprocess.py]
      args:
        [
          "--config",
          "{{inputs.artifacts.preprocessing-config.path}}",
          "--input",
          "{{inputs.artifacts.source-data.path}}",
          "--output",
          "/tmp/output/processed_data.csv",
        ]
    outputs:
      artifacts:
        - name: processed-data
          path: /tmp/output/processed_data.csv
          archive:
            none: {}

  train-hmm-model:
    inputs:
      artifacts:
        - name: processed-data
          path: /tmp/input/processed_data.csv
          archive:
            none: {}
        - name: training-hmm-config
          path: /tmp/config/training_hmm.json
    container:
      image: docker.io/library/training-hmm:v2
      imagePullPolicy: Never
      command: [python, entrenar_modelo.py]
      args:
        [
          "--input",
          "/tmp/input/processed_data.csv",
          "--output_model",
          "/tmp/output/hmm_model.pkl",
          "--params",
          "{{inputs.artifacts.training-hmm-config.path}}",
        ]
    outputs:
      artifacts:
        - name: trained-model
          path: /tmp/output/hmm_model.pkl
          archive:
            none: {}

  generate-hmm-data:
    inputs:
      artifacts:
        - name: trained-model
          path: /tmp/input/hmm_model.pkl
          archive:
            none: {}
        - name: generation-hmm-config
          path: /tmp/config/generation_hmm.json
    container:
      image: docker.io/library/generation-hmm:v2
      imagePullPolicy: Never
      command: [python, generar_datos.py]
      args:
        [
          "--model",
          "/tmp/input/hmm_model.pkl",
          "--output_data",
          "/tmp/output/synthetic_data.csv",
          "--params",
          "{{inputs.artifacts.generation-hmm-config.path}}",
        ]
    outputs:
      artifacts:
        - name: synthetic-data
          path: /tmp/output/synthetic_data.csv
          archive:
            none: {}

  train-gaussian-process-model:
    inputs:
      artifacts:
        - name: processed-data
          path: /tmp/input/processed_data.csv
          archive:
            none: {}
        - name: training-gaussian-process-config
          path: /tmp/config/training_gaussian_process.json
    container:
      image: docker.io/library/training-gaussian_process:v2
      imagePullPolicy: Never
      args:
        [
          "--data",
          "/tmp/input/processed_data.csv",
          "--output_model",
          "/tmp/output/gp_model.pkl",
          "--params",
          "{{inputs.artifacts.training-gaussian-process-config.path}}",
        ]
    outputs:
      artifacts:
        - name: trained-model
          path: /tmp/output/gp_model.pkl
          archive:
            none: {}

  generate-gaussian-process-data:
    inputs:
      artifacts:
        - name: trained-model
          path: /tmp/input/gp_model.pkl
          archive:
            none: {}
        - name: generation-gaussian-process-config
          path: /tmp/config/generation_gaussian_process.json
    container:
      image: docker.io/library/generation-gaussian_process:v2
      imagePullPolicy: Never
      args:
        [
          "--model",
          "/tmp/input/gp_model.pkl",
          "--output_data",
          "/tmp/output/synthetic_data.csv",
          "--params",
          "{{inputs.artifacts.generation-gaussian-process-config.path}}",
        ]
    outputs:
      artifacts:
        - name: synthetic-data
          path: /tmp/output/synthetic_data.csv
          archive:
            none: {}

  train-copulas-model:
    inputs:
      artifacts:
        - name: processed-data
          path: /tmp/input/processed_data.csv
          archive:
            none: {}
        - name: training-copulas-config
          path: /tmp/config/training_copulas.json
    container:
      image: docker.io/library/training-copulas:v2
      imagePullPolicy: Never
      args:
        [
          "--data",
          "/tmp/input/processed_data.csv",
          "--output_model",
          "/tmp/output/copulas_model.pkl",
          "--params",
          "{{inputs.artifacts.training-copulas-config.path}}",
        ]
    outputs:
      artifacts:
        - name: trained-model
          path: /tmp/output/copulas_model.pkl
          archive:
            none: {}

  generate-copulas-data:
    inputs:
      artifacts:
        - name: trained-model
          path: /tmp/input/copulas_model.pkl
          archive:
            none: {}
        - name: generation-copulas-config
          path: /tmp/config/generation_copulas.json
    container:
      image: docker.io/library/generation-copulas:v2
      imagePullPolicy: Never
      args:
        [
          "--model",
          "/tmp/input/copulas_model.pkl",
          "--output_data",
          "/tmp/output/synthetic_data.csv",
          "--params",
          "{{inputs.artifacts.generation-copulas-config.path}}",
        ]
    outputs:
      artifacts:
        - name: synthetic-data
          path: /tmp/output/synthetic_data.csv
          archive:
            none: {}

  train-boltzman-machines-model:
    inputs:
      artifacts:
        - name: processed-data
          path: /tmp/input/processed_data.csv
          archive:
            none: {}
        - name: training-boltzman-machines-config
          path: /tmp/config/training_boltzman_machines.json
    container:
      image: docker.io/library/training-boltzman_machines:v2
      imagePullPolicy: Never
      args:
        [
          "--data",
          "/tmp/input/processed_data.csv",
          "--output_model",
          "/tmp/output/rbm_model.pkl",
          "--params",
          "{{inputs.artifacts.training-boltzman-machines-config.path}}",
        ]
    outputs:
      artifacts:
        - name: trained-model
          path: /tmp/output/rbm_model.pkl
          archive:
            none: {}

  generate-boltzman-machines-data:
    inputs:
      artifacts:
        - name: trained-model
          path: /tmp/input/rbm_model.pkl
          archive:
            none: {}
        - name: generation-boltzman-machines-config
          path: /tmp/config/generation_boltzman_machines.json
    container:
      image: docker.io/library/generation-boltzman_machines:v2
      imagePullPolicy: Never
      args:
        [
          "--model",
          "/tmp/input/rbm_model.pkl",
          "--output_data",
          "/tmp/output/synthetic_data.csv",
          "--params",
          "{{inputs.artifacts.generation-boltzman-machines-config.path}}",
        ]
    outputs:
      artifacts:
        - name: synthetic-data
          path: /tmp/output/synthetic_data.csv
          archive:
            none: {}

  train-bayesian-networks-model:
    inputs:
      artifacts:
        - name: processed-data
          path: /tmp/input/processed_data.csv
          archive:
            none: {}
        - name: training-bayesian-networks-config
          path: /tmp/config/training_bayesian_networks.json
    container:
      image: docker.io/library/training-bayesian_networks:v2
      imagePullPolicy: Never
      args:
        [
          "--data",
          "/tmp/input/processed_data.csv",
          "--output_model",
          "/tmp/output/bn_model.pkl",
          "--params",
          "{{inputs.artifacts.training-bayesian-networks-config.path}}",
        ]
    outputs:
      artifacts:
        - name: trained-model
          path: /tmp/output/bn_model.pkl
          archive:
            none: {}

  generate-bayesian-networks-data:
    inputs:
      artifacts:
        - name: trained-model
          path: /tmp/input/bn_model.pkl
          archive:
            none: {}
        - name: generation-bayesian-networks-config
          path: /tmp/config/generation_bayesian_networks.json
    container:
      image: docker.io/library/generation-bayesian_networks:v2
      imagePullPolicy: Never
      args:
        [
          "--model",
          "/tmp/input/bn_model.pkl",
          "--output_data",
          "/tmp/output/synthetic_data.csv",
          "--params",
          "{{inputs.artifacts.generation-bayesian-networks-config.path}}",
        ]
    outputs:
      artifacts:
        - name: synthetic-data
          path: /tmp/output/synthetic_data.csv
          archive:
            none: {}

